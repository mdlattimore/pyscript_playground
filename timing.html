<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Code Timer</title>
        <!-- Latest compiled and minified CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <!-- Latest compiled JavaScript -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- PyScript import -->
        <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
  
    </head>

    <body>
        <div class="container-fluid p-4 bg-primary text-white text-center">
            <h1 style="font-size: 4em">JS/PyS Code Timer</h1>
        </div>
        <div class="row">
            <div col="col-sm-12">&nbsp;</div>
        </div>
        <div class="container-fluid px-5 pt-3">
            <div class="row">
                <div class="col-sm-1"></div>
                <div class="col-sm-5">
                    <p style="font-size: 1.20em">This is a simple code timer that measures (in milliseconds) how long it takes code running in the browser to count from 0 to 1,000,000. The timer begins when you click one of the "Go!" buttons. The top button executes a JavaScript function. The middle button executes an equivalent function written in Python, running within the PyScript framework (which allows Python to be run directly in the browser). The bottom button executes both (though not simultaneously--keep reading).</p>
                    <p>For added fun, open the console and run each function and both together. The console will print the start and completed time for each function. Regardless of the order in which the onClick events appear in the html or the order of the scripts in the body of the html, the JavaScript function always runs first.</p>
                    <br>
                </div>
                <div class="col-sm-1"></div>  
                <div class="col-sm-4">
                    <h2>JavaScript Function</h2>
                        <div class="row">
                            <div class="col-sm-2">
                                <button type="submit" id="js_btn" name="js_btn" onClick="js_run()">Go!</button>
                            </div>    
                        </div>
                    <p id="js_result">&nbsp;</p>
                    <br>
                    <h2>Python Function</h2>
                        <div class="row">
                            <div class="col-sm-2">
                                <button type="submit" id="py_btn" name="py_btn" pys-onclick="py_run">Go!</button>
                            </div>    
                        </div>   
                    <p id="py_result">&nbsp;</p>
                    <br>
                    <h2>Run Both</h2>
                    <div class="row">
                        <div class="col-sm-2">
                            <button type="submit" id="both_btn" name="both_btn" pys-onclick="py_run" onClick="js_run()" p>Go!</button>
                        </div>
                        <br>
                        <br>
                    </div>
                </div>    
            </div>
            
        </div>    
        
<py-script>
    import time

    def py_run(*args, **kwargs):
        
        x = 0
        start = time.perf_counter()
        console.log(f"Python start: {start * 1000}")
        while x < 1000000:
            x += 1
        stop = time.perf_counter()
        timed = f"{(stop - start) * 1000}"
        console.log(f"Python executed: {stop * 1000}")
        <!-- console.log(x) --> 
        display = f"{timed} milliseconds"
        Element('py_result').write(display)
</py-script>

<script>
    function js_run() {
        
        let x = 0;
        start = performance.now();
        console.log(`JS start ${start}`)
        while (x < 1000000) {
            x++;
        }
        stop = performance.now();
        console.log(`JS executed ${stop}`)
        // console.log(x)
        
        let total = stop - start;
        let times = total.toString();
        document.getElementById('js_result').innerHTML = `${times} milliseconds`;
        // event.defaultPrevented;
    }
</script>

    </body>
</html>